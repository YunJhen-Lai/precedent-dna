<!DOCTYPE html> 
<html>
<head>
  <meta charset="UTF-8">
  <title>ğŸ“˜ Submit Precedent DNA Cases</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea { width: 100%; font-family: monospace; }
    button { font-size: 16px; padding: 10px 20px; }
  </style>
</head>
<body>
  <h2>ğŸ“˜ ä¸€éµæäº¤å¤šç­†æ¡ˆä¾‹åˆ° GitHub çŸ¥è­˜åº«</h2>

  <p>è«‹å°‡ä¸‹åˆ—æ ¼å¼è²¼å…¥ï¼ŒæŒ‰ä¸‹æŒ‰éˆ•å³å¯é€å‡ºæ‰€æœ‰æ¡ˆä¾‹ï¼š</p>
  <textarea id="json_input" rows="20">[
  {
    "filename": "case_test_write.json",
    "content": {
      "case_id": "case_test_write",
      "project_name": "Webhook æ¸¬è©¦æ¡ˆä¾‹",
      "data_sources": ["GPT Analysis"],
      "Gene_A": {},
      "Gene_B": {},
      "Gene_C1": [],
      "Gene_C2": [],
      "Gene_D": {},
      "notes": "",
      "source": "GPT semantic analysis v1.0"
    }
  }
]</textarea>

  <br><br>
  <button onclick="submitAll()">ğŸ“¤ Submit All Cases</button>

  <div id="result" style="margin-top: 20px; white-space: pre-wrap;"></div>

  <script>
    async function submitAll() {
      const inputText = document.getElementById("json_input").value;
      const resultDiv = document.getElementById("result");
      resultDiv.innerText = "â³ æ­£åœ¨é€å‡ºï¼Œè«‹ç¨å€™...\n";

      try {
        const cases = JSON.parse(inputText);

        if (!Array.isArray(cases)) {
          resultDiv.innerText = "âŒ è«‹æä¾›ä¸€å€‹ JSON é™£åˆ—";
          return;
        }

        for (const data of cases) {
          const response = await fetch("https://ac907e17-3c44-4b93-bc13-bbbcc4afb4a5-00-2wk9a5dxu9yqb.pike.replit.dev/push_case", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              filename: data.filename,
              message: "Add " + data.filename,
              content: data.content
            })
          });

          const text = await response.text();
          if (response.ok) {
            resultDiv.innerText += `âœ… ${data.filename} æˆåŠŸé€å‡º\n`;
          } else {
            resultDiv.innerText += `âŒ ${data.filename} å¤±æ•—ï¼š${text}\n`;
          }
        }

        resultDiv.innerText += "\nğŸ“ è«‹å‰å¾€ GitHub Repo ç¢ºèªè³‡æ–™æ˜¯å¦å¯«å…¥æˆåŠŸã€‚";
      } catch (e) {
        resultDiv.innerText = "âš ï¸ JSON æ ¼å¼éŒ¯èª¤ï¼Œè«‹å†æ¬¡ç¢ºèªè¼¸å…¥\n" + e;
      }
    }
  </script>
</body>
</html>
