<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ğŸ“˜ Submit Precedent DNA Cases</title>
</head>
<body>
  <h2>ğŸ“˜ ä¸€éµæäº¤å¤šç­†æ¡ˆä¾‹åˆ° GitHub çŸ¥è­˜åº«</h2>

  <p>è«‹å°‡ä¸‹åˆ—æ ¼å¼è²¼å…¥ï¼ŒæŒ‰ä¸‹æŒ‰éˆ•å³å¯é€å‡ºæ‰€æœ‰æ¡ˆä¾‹ï¼š</p>
  <textarea id="json_input" rows="20" cols="100">[
  {
    "filename": ".json",
    "content": {
      "case_id": "",
      "project_name": "",
      "data_sources": ["GPT Analysis"],
      "Gene_A": {},
      "Gene_B": {},
      "Gene_C1": [],
      "Gene_C2": [],
      "Gene_D": {},
      "notes": "",
      "source": "GPT semantic analysis v1.0"
    }
  }
]</textarea>

  <br><br>
  <button onclick="submitAll()">ğŸ“¤ Submit All Cases</button>

  <script>
    function submitAll() {
      let inputText = document.getElementById("json_input").value;

      try {
        const cases = JSON.parse(inputText);

        if (!Array.isArray(cases)) {
          alert("è«‹æä¾›ä¸€å€‹ JSON é™£åˆ—");
          return;
        }

        cases.forEach(data => {
          fetch("https://precedent-dna-webhook.yunjen20030303.repl.co/push_case", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              filename: data.filename,
              message: "Add " + data.filename,
              content: data.content
            })
          })
          .then(response => response.text())
          .then(text => console.log(`âœ… ${data.filename} å›æ‡‰ï¼š` + text))
          .catch(error => console.error(`âŒ ${data.filename} ç™¼é€éŒ¯èª¤ï¼š`, error));
        });

        alert("ğŸ“¨ æ‰€æœ‰æ¡ˆä¾‹å·²é€å‡ºï¼Œè«‹æŸ¥çœ‹ GitHub Repoï¼");
      } catch (e) {
        alert("âš ï¸ JSON æ ¼å¼éŒ¯èª¤ï¼Œè«‹å†æ¬¡ç¢ºèªè¼¸å…¥");
        console.error(e);
      }
    }
  </script>
</body>
</html>
